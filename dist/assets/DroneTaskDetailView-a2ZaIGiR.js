import{d as D,r as v,o as g,p as C,c as _,b as s,g as d,t as n,e as f,x as p,j as m,k,l as c,m as I,F as B,h as A,M as P,f as u,_ as N}from"./index-B4NwbyMr.js";import"@element-plus/icons-vue";function S(){try{if(!window.map){console.warn("地图实例不存在，无法清除点位");return}window.droneMarker&&(window.map.remove(window.droneMarker),window.droneMarker=null),window.polygons&&window.polygons.length>0&&(window.map.remove(window.polygons),window.polygons=[]),window.markers&&window.markers.length>0&&(window.map.remove(window.markers),window.markers=[]),console.log("成功清除地图上所有点位和多边形")}catch(w){console.error("清除地图点位时发生错误:",w)}}const V={class:"drone-task-detail"},x={class:"task-sidebar"},U={class:"header"},$={class:"task-info"},F={class:"info-item"},L={class:"value"},j={class:"info-item"},q={class:"value"},z={class:"info-item"},E={class:"value"},R={class:"info-item"},X={class:"value"},G={class:"info-item"},H={class:"value"},J={class:"info-item"},K={class:"value status"},O={class:"drone-info"},Q={class:"drone-card"},W={class:"drone-header"},Y={class:"drone-name"},Z={class:"drone-stats"},ss={class:"stat-item"},ts={class:"stat-value"},es={class:"stat-item"},os={class:"stat-value"},ns={class:"stat-item"},as={class:"stat-value"},ls={class:"stat-item"},is={class:"stat-value"},ds={class:"action-buttons"},rs={class:"map-container"},vs={class:"map-header"},us={class:"map-controls"},cs={class:"map-type-selector"},ps=["onClick"],ms={class:"map-wrapper"},ws=D({__name:"DroneTaskDetailView",setup(w){const e=v({id:"DRN-2023-0542",type:"区域巡检",startTime:"2023-11-08 14:30",endTime:"2023-11-08 17:30",droneId:"Drone-X10",batteryLevel:"78% (约2小时15分)",signalStrength:"87% (良好)"});v([{id:"A",type:"person",name:"人群聚集点A",description:"约45人，活动正常",position:{lng:116.393428,lat:39.91123},status:"normal"},{id:"B",type:"traffic",name:"交通监控点B",description:"车流量中等，无拥堵",position:{lng:116.397428,lat:39.90623},status:"normal"},{id:"C",type:"warning",name:"重点区域C",description:"检测到异常活动，建议关注",position:{lng:116.401428,lat:39.90923},status:"warning"},{id:"D",type:"parking",name:"车辆集中点D",description:"停放正常，车位充足",position:{lng:116.395428,lat:39.90523},status:"normal"}]);const a=v({lng:116.397428,lat:39.90923});v(null);const y=["标准地图","卫星模式","3D图像","热力图"],b=v("标准地图"),h=o=>{b.value=o,console.log("切换地图类型:",o)};g(()=>{console.log("组件挂载，清理地图点"),setTimeout(()=>{try{S()}catch(o){console.error("清理地图点失败:",o)}},1e3)}),C(()=>{r!==null&&clearInterval(r)});let r=null;const M=()=>{r!==null&&clearInterval(r);let o=0;const t=[{lng:116.386037,lat:39.913122},{lng:116.389684,lat:39.904507},{lng:116.405563,lat:39.90654},{lng:116.401787,lat:39.915309},{lng:116.393428,lat:39.91123},{lng:116.397428,lat:39.90623},{lng:116.401428,lat:39.90923},{lng:116.395428,lat:39.90523}];r=window.setInterval(()=>{const l=t[o];a.value={lng:a.value.lng+(l.lng-a.value.lng)*.1,lat:a.value.lat+(l.lat-a.value.lat)*.1},Math.sqrt(Math.pow(a.value.lng-l.lng,2)+Math.pow(a.value.lat-l.lat,2))<2e-4&&(o=(o+1)%t.length),T()},500)},T=()=>{window.map&&window.droneMarker&&window.droneMarker.setPosition(a.value)};return g(()=>{setTimeout(()=>{M()},2e3)}),(o,t)=>{const l=I("el-button");return u(),_("div",V,[s("div",x,[s("div",U,[s("div",{class:"back-button",onClick:t[0]||(t[0]=i=>o.$router.push("/dashboard"))},t[1]||(t[1]=[s("i",{class:"el-icon-arrow-left"},null,-1),d(" 返回 ")])),t[2]||(t[2]=s("div",{class:"title"},"任务详情",-1))]),s("div",$,[s("div",F,[t[3]||(t[3]=s("div",{class:"label"},"任务ID",-1)),s("div",L,n(e.value.id),1)]),s("div",j,[t[4]||(t[4]=s("div",{class:"label"},"任务名称",-1)),s("div",q,n(e.value.name),1)]),s("div",z,[t[5]||(t[5]=s("div",{class:"label"},"开始时间",-1)),s("div",E,n(e.value.startTime),1)]),s("div",R,[t[6]||(t[6]=s("div",{class:"label"},"任务区域",-1)),s("div",X,n(e.value.area),1)]),s("div",G,[t[7]||(t[7]=s("div",{class:"label"},"任务类型",-1)),s("div",H,n(e.value.type),1)]),s("div",J,[t[8]||(t[8]=s("div",{class:"label"},"任务状态",-1)),s("div",K,[s("span",{class:f(["status-dot",e.value.status])},null,2),d(" "+n(o.getStatusText(e.value.status)),1)])])]),s("div",O,[t[14]||(t[14]=s("div",{class:"section-title"},"执行无人机",-1)),s("div",Q,[s("div",W,[t[9]||(t[9]=s("img",{src:"",alt:"无人机",class:"drone-image"},null,-1)),s("div",Y,n(e.value.droneName),1)]),s("div",Z,[s("div",ss,[t[10]||(t[10]=s("div",{class:"stat-icon battery"},null,-1)),s("div",ts,n(e.value.droneBattery)+"%",1)]),s("div",es,[t[11]||(t[11]=s("div",{class:"stat-icon signal"},null,-1)),s("div",os,n(e.value.droneSignal)+"%",1)]),s("div",ns,[t[12]||(t[12]=s("div",{class:"stat-icon altitude"},null,-1)),s("div",as,n(e.value.droneAltitude)+"m",1)]),s("div",ls,[t[13]||(t[13]=s("div",{class:"stat-icon speed"},null,-1)),s("div",is,n(e.value.droneSpeed)+"km/h",1)])])])]),s("div",ds,[e.value.status==="waiting"?(u(),p(l,{key:0,type:"primary"},{default:c(()=>t[15]||(t[15]=[d("开始任务")])),_:1})):m("",!0),e.value.status==="running"?(u(),p(l,{key:1,type:"danger"},{default:c(()=>t[16]||(t[16]=[d("终止任务")])),_:1})):m("",!0),e.value.status==="running"?(u(),p(l,{key:2,type:"info"},{default:c(()=>t[17]||(t[17]=[d("暂停任务")])),_:1})):m("",!0),k(l,null,{default:c(()=>t[18]||(t[18]=[d("导出报告")])),_:1})])]),s("div",rs,[s("div",vs,[t[19]||(t[19]=s("div",{class:"map-title"},"实时监控",-1)),s("div",us,[s("div",cs,[(u(),_(B,null,A(y,i=>s("div",{key:i.value,class:f(["type-item",{active:o.currentMapType===i.value}]),onClick:gs=>h(i.value)},n(i.label),11,ps)),64))])])]),s("div",ms,[k(P,{"task-type":o.currentMapType,"drone-position":a.value,"onUpdate:taskAreaPoints":o.updateTaskArea},null,8,["task-type","drone-position","onUpdate:taskAreaPoints"])])])])}}}),ks=N(ws,[["__scopeId","data-v-331a9ccc"]]);export{ks as default};
